metadata:
    language: v1-beta
    name: "secret-hunter"
    description: "Detects common keys, tokens, credentials, private keys, and exposed sensitive artifacts"
    tags: "secrets","credentials","misconfiguration", "exposure", "token"

given response then
    if {latest.response} matches "[a-zA-Z0-9_\\-]{32,45}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched generic_api_key"
            remediation: "Remove secrets from responses and rotate exposed credentials."
    end if

    if {latest.response} matches "[a-zA-Z0-9_\\-]{40,60}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched generic_auth_token"
            remediation: "Remove secrets from responses and rotate exposed credentials."
    end if

    if {latest.response} matches "AZURE_[A-Za-z0-9+/]+={0,2}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched azure_access_key"
            remediation: "Rotate Azure access keys and avoid exposing them in responses."
    end if

    if {latest.response} matches "\"type\":\\s*\"service_account\"" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched gcp_service_account"
            remediation: "Do not expose service account JSON in client-facing content."
    end if

    if {latest.response} matches "heroku_[a-zA-Z0-9]{25,40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched heroku_api_key"
            remediation: "Rotate Heroku API keys and remove them from application output."
    end if

    if {latest.response} matches "linode_[a-zA-Z0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched linode_access_token"
            remediation: "Rotate Linode tokens and avoid exposing them in responses."
    end if

    if {latest.response} matches "[a-f0-9]{64}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched hash/token candidate (digitalocean_token/sha256)"
            remediation: "Validate if this is sensitive; if so, rotate and remove from output."
    end if

    if {latest.response} matches "https://[a-z0-9-]+\\.firebaseio\\.com" then
        report issue:
            severity: medium
            confidence: firm
            detail: "Matched firebase_database_url"
            remediation: "Restrict Firebase DB access and avoid exposing internal URLs."
    end if

    if {latest.response} matches "xox[baprs]-[a-zA-Z0-9]{10,48}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched slack_token"
            remediation: "Rotate Slack token and remove from response content."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{24}\\.[a-zA-Z0-9_-]{6}\\.[a-zA-Z0-9_-]{27}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched discord_token"
            remediation: "Rotate Discord token and remove from response content."
    end if

    if {latest.response} matches "AKIA[0-9A-Z]{16}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched aws_access_key"
            remediation: "Rotate AWS key immediately and remove it from output/logs."
    end if

    if {latest.response} matches "-----BEGIN OPENSSH PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched private_ssh_key"
            remediation: "Remove private keys from responses and rotate compromised keys."
    end if

    if {latest.response} matches "-----BEGIN (RSA|EC|DSA|OPENSSH) PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched jwt/private key material"
            remediation: "Private key material must never be exposed in application responses."
    end if

    if {latest.response} matches "glpat-[a-zA-Z0-9\\-_]{20,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched gitlab_personal_access_token"
            remediation: "Rotate GitLab token and remove it from exposed content."
    end if

    if {latest.response} matches "ghp_[A-Za-z0-9]{36}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched github_personal_access_token"
            remediation: "Rotate GitHub PAT and remove it from exposed content."
    end if

    if {latest.response} matches "gho_[A-Za-z0-9]{36}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched github_oauth_token"
            remediation: "Rotate GitHub OAuth token and remove it from exposed content."
    end if

    if {latest.response} matches "sk-[a-zA-Z0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched openai_api_key"
            remediation: "Rotate OpenAI key and avoid embedding secrets in frontend responses."
    end if

    if {latest.response} matches "hf_[A-Za-z0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched huggingface_api_key"
            remediation: "Rotate Hugging Face key and remove from response artifacts."
    end if

    if {latest.response} matches "(authorization|jwt|token|access_token)[\"':=\\s]+ey[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_.+/=]*" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched jwt_token_with_auth"
            remediation: "Do not expose active JWTs in responses; invalidate leaked tokens."
    end if

    if {latest.response} matches "Bearer\\s+ey[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_.+/=]*" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched jwt_bearer_token"
            remediation: "Do not return bearer JWTs in response content."
    end if

    if {latest.response} matches "https://hooks\\.slack\\.com/services/[A-Za-z0-9]+/[A-Za-z0-9]+/[A-Za-z0-9]+" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched slack_webhook_url"
            remediation: "Regenerate Slack webhook and remove from public responses."
    end if

    if {latest.response} matches "https://[a-zA-Z0-9]+\\.webhook\\.office\\.com/webhookb2/[a-zA-Z0-9-]+@[a-zA-Z0-9-]+/IncomingWebhook/[a-zA-Z0-9-]+/[a-zA-Z0-9-]+" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched ms_teams_webhook"
            remediation: "Regenerate Teams webhook and avoid exposing it in responses."
    end if

    if {latest.response} matches "postgresql://[a-zA-Z0-9_]+:[a-zA-Z0-9!@#$%^&*()_+=\\-]{8,}@[a-zA-Z0-9.\\-]+:[0-9]+/[a-zA-Z0-9_]+" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched postgresql_uri"
            remediation: "Remove DB credentials from output and rotate exposed credentials."
    end if

    if {latest.response} matches "mongodb(\\+srv)?://[a-zA-Z0-9._%+-]+:[a-zA-Z0-9!@#$%^&*()_+=\\-]+@[a-zA-Z0-9._%+-]+" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched mongodb_uri"
            remediation: "Remove DB connection strings from output and rotate credentials."
    end if

    if {latest.response} matches "mysql://[a-zA-Z0-9._%+-]+:[a-zA-Z0-9._%+-]+@[a-zA-Z0-9._%+-]+/[a-zA-Z0-9]+" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched mysql_connection_string"
            remediation: "Remove DB credentials from output and rotate credentials."
    end if

    if {latest.response} matches "(?i)(api|secret|key|token|password)[\"':=]{0,10}[a-zA-Z0-9_/+=-]{8,64}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched proximity_sensitive"
            remediation: "Review response for hardcoded credentials and remove sensitive values."
    end if

    if {latest.response} matches "https?://[a-zA-Z0-9._-]+/\\.env" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched exposed_env_file"
            remediation: "Block `.env` access and remove sensitive files from web root."
    end if

    if {latest.response} matches "/\\.git(/|$)" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched git_exposed"
            remediation: "Prevent direct `.git` exposure and restrict repository metadata access."
    end if

    if {latest.response} matches "define\\(\\s*['\"]DB_PASSWORD['\"],\\s*['\"][^'\"]+['\"]\\s*\\)" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched wordpress_db_password"
            remediation: "Move DB credentials out of exposed files and rotate password."
    end if

    if {latest.response} matches "base64:[A-Za-z0-9+/=]{32,64}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched laravel_key"
            remediation: "Do not expose application keys; rotate if exposed."
    end if

    if {latest.response} matches "[0-9]{9}:[a-zA-Z0-9_-]{35}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched telegram_bot_token"
            remediation: "Rotate Telegram bot token and remove from output."
    end if

    if {latest.response} matches "pk_live_[0-9a-zA-Z]{24}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched stripe_publishable_key"
            remediation: "Confirm publishable key usage is intended and scoped correctly."
    end if

    if {latest.response} matches "sk_live_[0-9a-zA-Z]{24}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched stripe_secret_key"
            remediation: "Rotate Stripe secret key and move it server-side only."
    end if

    if {latest.response} matches "whsec_[a-zA-Z0-9]{32,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched stripe_webhook_secret"
            remediation: "Rotate webhook secret and avoid exposing it in any response artifacts."
    end if

    if {latest.response} matches "(10\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}|192\\.168\\.[0-9]{1,3}\\.[0-9]{1,3}|172\\.(1[6-9]|2[0-9]|3[0-1])\\.[0-9]{1,3}\\.[0-9]{1,3})" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched internal_ip_pattern"
            remediation: "Review whether internal addressing details should be exposed."
    end if

    if {latest.response} matches "https?://(10|172\\.1[6-9]|172\\.2[0-9]|172\\.3[0-1]|192\\.168)\\.[0-9]{1,3}\\.[0-9]{1,3}(:[0-9]+)?" then
        report issue:
            severity: medium
            confidence: firm
            detail: "Matched internal_url"
            remediation: "Remove internal network URLs from externally visible responses."
    end if

    if {latest.response} matches "(debug|test|staging)[-_]?(url|host|endpoint|server)[\"']?\\s*[:=]\\s*[\"']?[a-zA-Z0-9\\-_.]+" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched debug_endpoints"
            remediation: "Remove debug/staging endpoint details from production responses."
    end if

    if {latest.response} matches "process\\.env\\.[A-Za-z0-9_]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched exposed_runtime_env"
            remediation: "Avoid exposing environment variable references in client-delivered code."
    end if

    if {latest.response} matches "[A-Z_]+=[A-Za-z0-9/+=_\\-]{20,100}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched env_var_assignment"
            remediation: "Do not expose secret-like environment assignments in responses."
    end if

    if {latest.response} matches "[a-z0-9]{32}-us[0-9]{1,2}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched mailchimp_api_key"
            remediation: "Rotate Mailchimp API key and remove it from output."
    end if

    if {latest.response} matches "dd_api_key=[a-zA-Z0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched datadog_api_key"
            remediation: "Rotate Datadog key and remove it from output."
    end if

    if {latest.response} matches "sq0atp-[0-9A-Za-z\\-_]{22,43}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched square_access_token"
            remediation: "Rotate Square token and remove it from output."
    end if

    if {latest.response} matches "v1\\.[a-zA-Z0-9_-]{40,60}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched cloudflare_token"
            remediation: "Rotate Cloudflare token and remove it from output."
    end if

    if {latest.response} matches "LTAI[0-9A-Za-z]{20}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched alibaba_access_key"
            remediation: "Rotate Alibaba/Aliyun access key and remove from output."
    end if

    if {latest.response} matches "OCID[0-9a-zA-Z._-]{30,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched oracle_cloud_api_key"
            remediation: "Rotate Oracle Cloud credentials and remove from response artifacts."
    end if

    if {latest.response} matches "kubeconfig" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched kubernetes_config"
            remediation: "Do not expose kubeconfig or cluster administrative artifacts."
    end if

    if {latest.response} matches "//registry\\.npmjs\\.org/:_authToken=[a-zA-Z0-9\\-_]{36,}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched npm_token"
            remediation: "Rotate npm token and avoid exposing package credentials."
    end if

    if {latest.response} matches "_authToken=[\"'][a-zA-Z0-9+/=]{20,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched npmrc_auth_token"
            remediation: "Remove package manager auth tokens and rotate credentials."
    end if

    if {latest.response} matches "(GITHUB|GITLAB|NPM)_TOKEN=[a-zA-Z0-9]{36,}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched code_artifacts token"
            remediation: "Remove CI/CD tokens from exposed content and rotate them."
    end if

    if {latest.response} matches "https://api\\.stripe\\.com/v1/webhooks/[a-zA-Z0-9]{32}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched stripe_webhook_endpoint"
            remediation: "Review webhook exposure and ensure no secret material is leaked."
    end if

    if {latest.response} matches "https?://[a-zA-Z0-9._-]+/(config|settings|secrets)\\.json" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched exposed_config_url"
            remediation: "Restrict access to config endpoints/files and remove sensitive data."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{24}\\.[a-zA-Z0-9_-]{6}\\.[a-zA-Z0-9_-]{27}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched discord_bot_token"
            remediation: "Rotate Discord bot token and remove from output."
    end if

    if {latest.response} matches "https://index\\.docker\\.io/v1/" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched docker_registry"
            remediation: "Review whether registry URLs and auth context are unintentionally exposed."
    end if

    if {latest.response} matches "JENKINS_ADMIN_PASSWORD=[\"'][a-zA-Z0-9@#$%^&+=]{8,}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched jenkins_admin_password"
            remediation: "Rotate Jenkins admin password and remove from responses."
    end if

    if {latest.response} matches "Jenkins-Crumb:\\s*[a-zA-Z0-9]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched jenkins_crumb"
            remediation: "Avoid exposing security headers/tokens in publicly accessible responses."
    end if

    if {latest.response} matches "https://storage\\.googleapis\\.com/[a-zA-Z0-9_/-]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched gcp_bucket_url"
            remediation: "Review bucket exposure and ensure access controls are properly set."
    end if

    if {latest.response} matches "[a-z0-9]{3,24}\\.blob\\.core\\.windows\\.net" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched azure_storage_account"
            remediation: "Validate blob endpoints are intended to be public and non-sensitive."
    end if

    if {latest.response} matches "[A-Za-z0-9]{4,6}-[A-Za-z0-9]{4,6}-[A-Za-z0-9]{4,6}-[A-Za-z0-9]{4,6}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched software_license_key pattern"
            remediation: "Confirm software/license keys are not being leaked in responses."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{32}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched generic 32-char token pattern"
            remediation: "Review if this is sensitive; rotate and remove if credential material."
    end if
    if {latest.response} matches "AAAA[A-Za-z0-9_-]{7}:[A-Za-z0-9_-]{140}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched firebase_api_key"
            remediation: "Rotate Firebase API key and avoid exposing it in responses."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{25,35}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched auth0_client_id"
            remediation: "Validate whether Auth0 identifiers are unintentionally exposed."
    end if

    if {latest.response} matches "[a-zA-Z0-9-_]{43,64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched auth0_client_secret"
            remediation: "Rotate Auth0 secret and remove from response artifacts."
    end if

    if {latest.response} matches "client_id=[A-Za-z0-9-_]{20,50}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched paypal_client_id_v1"
            remediation: "Review PayPal client identifiers and ensure no sensitive credentials are leaked."
    end if

    if {latest.response} matches "secret=[A-Za-z0-9-_]{20,50}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched paypal_secret_v1"
            remediation: "Rotate PayPal secret and remove it from exposed responses."
    end if

    if {latest.response} matches "ACCESSTOKEN_[a-zA-Z0-9_-]{60}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched venmo_access_token"
            remediation: "Rotate Venmo access token and remove it from output."
    end if

    if {latest.response} matches "\"private_key\":\\s*\"-----BEGIN PRIVATE KEY-----[a-zA-Z0-9/+=\\\\n]+-----END PRIVATE KEY-----\"" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched google_private_key"
            remediation: "Remove private key material from responses and rotate compromised credentials."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{25}-[a-zA-Z0-9]{40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched twitter_api_key"
            remediation: "Rotate Twitter API key and remove from exposed responses."
    end if

    if {latest.response} matches "[1-9][0-9]{18}-[a-zA-Z0-9]{40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched twitter_access_token"
            remediation: "Rotate Twitter access token and avoid exposing token material."
    end if

    if {latest.response} matches "[0-9]{13,17}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched facebook_client_id"
            remediation: "Validate whether Facebook app identifiers are intentionally public."
    end if

    if {latest.response} matches "[a-f0-9]{32}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched facebook_secret"
            remediation: "Review if this value is a secret and rotate if exposed."
    end if

    if {latest.response} matches "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched smtp_username"
            remediation: "Review exposed email-style usernames in responses."
    end if

    if {latest.response} matches "[a-zA-Z0-9!@#$%^&*()_+=\\-]{8,}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched smtp_password"
            remediation: "Validate whether credential-like strings are exposed."
    end if

    if {latest.response} matches "mqtt_pass[a-zA-Z0-9!@#$%^&*()_+=\\-]{8,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched mqtt_password"
            remediation: "Rotate MQTT credentials and remove them from output."
    end if

    if {latest.response} matches "-----BEGIN PRIVATE KEY-----[A-Za-z0-9+/=]{100,}-----END PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched iot_private_key"
            remediation: "Never expose IoT private key material; rotate immediately."
    end if

    if {latest.response} matches "eyJ[A-Za-z0-9-_=]+\\.eyJ[A-Za-z0-9-_=]+\\.?[A-Za-z0-9-_.+/=]*" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched jwt_token_extended"
            remediation: "Avoid exposing JWTs in responses and invalidate leaked tokens."
    end if

    if {latest.response} matches "aws_secret_access_key\\s*=\\s*[a-zA-Z0-9/+=]{40}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched amazon_secret_key"
            remediation: "Rotate AWS secret key and remove credential leakage from responses."
    end if

    if {latest.response} matches "[a-zA-Z0-9._\\-]{1,256}\\.s3\\.amazonaws\\.com" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched amazon_bucket_name"
            remediation: "Review S3 bucket exposure and ensure proper access control."
    end if

    if {latest.response} matches "\"project_id\":\\s*\"[a-z0-9\\-]+\"" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched gcp_project_id"
            remediation: "Validate GCP project metadata exposure."
    end if

    if {latest.response} matches "\"client_email\":\\s*\"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\"" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched gcp_client_email"
            remediation: "Avoid exposing service-account identity details in responses."
    end if

    if {latest.response} matches "\"private_key_id\":\\s*\"[a-f0-9]{40}\"" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched gcp_private_key_id"
            remediation: "Treat private key identifiers as sensitive metadata and remove from responses."
    end if

    if {latest.response} matches "([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched azure_client_id_uuid"
            remediation: "Validate whether UUID-like tenant/client IDs are unnecessarily exposed."
    end if

    if {latest.response} matches "([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched azure_tenant_id_uuid"
            remediation: "Validate whether UUID-like tenant/client IDs are unnecessarily exposed."
    end if

    if {latest.response} matches "([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched azure_subscription_id_uuid"
            remediation: "Validate whether UUID-like subscription IDs are unnecessarily exposed."
    end if

    if {latest.response} matches "\"mysql_password\":\\s*\"[a-zA-Z0-9@#$%^&*()_+=\\-]{8,}\"" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched mysql_password_json"
            remediation: "Remove database passwords from responses and rotate exposed credentials."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{32}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched jenkins_api_token"
            remediation: "Review whether token-like values are sensitive and rotate where necessary."
    end if

    if {latest.response} matches "[a-f0-9]{40}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched travis_ci_api_token"
            remediation: "Rotate CI token if exposed and remove from response."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{30,50}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched circleci_token"
            remediation: "Rotate CircleCI token if exposed and remove from response."
    end if

    if {latest.response} matches "[a-zA-Z0-9_-]{20,40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched paypal_client_secret_v1"
            remediation: "Rotate PayPal client secret and remove from output."
    end if

    if {latest.response} matches "[a-zA-Z0-9-]+\\.[a-zA-Z0-9-]+\\.iot\\.[a-zA-Z0-9-]+\\.amazonaws\\.com" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched aws_iot_endpoint"
            remediation: "Review whether IoT endpoint exposure is intended."
    end if

    if {latest.response} matches "[0-9]{13}:[a-z0-9]{32}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched firebase_app_id"
            remediation: "Validate Firebase app identifier exposure."
    end if

    if {latest.response} matches "KeyStore JKS" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched android_keystore"
            remediation: "Avoid exposing keystore artifacts in responses."
    end if

    if {latest.response} matches "AIza[0-9A-Za-z-_]{35}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched android_google_maps_key"
            remediation: "Restrict Google Maps key and remove from exposed content if sensitive."
    end if

    if {latest.response} matches "00[a-zA-Z0-9]{22}\\.[a-zA-Z0-9]{6}\\.[a-zA-Z0-9-_]{43}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched okta_api_token"
            remediation: "Rotate Okta API token and remove from output."
    end if

    if {latest.response} matches "client_id:[a-zA-Z0-9-]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched onelogin_client_id"
            remediation: "Review OneLogin client metadata exposure."
    end if

    if {latest.response} matches "client_secret:[a-zA-Z0-9-]+" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched onelogin_client_secret"
            remediation: "Rotate OneLogin secret and remove it from response content."
    end if

    if {latest.response} matches "Bearer\\s+[a-zA-Z0-9-._~+/]+=*" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched generic_bearer_token"
            remediation: "Avoid exposing bearer tokens in responses and rotate if active."
    end if

    if {latest.response} matches "[a-f0-9]{32}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched shopify_access_token"
            remediation: "Validate if this 32-hex value is a Shopify/access token and rotate if needed."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched zendesk_api_token"
            remediation: "Rotate Zendesk token and remove it from output."
    end if

    if {latest.response} matches "\\.(bak|backup|old|sql|gz|zip)$" then
        report issue:
            severity: low
            confidence: firm
            detail: "Matched backup_file"
            remediation: "Restrict access to backup files and remove sensitive archives from web root."
    end if

    if {latest.response} matches "\\.log$" then
        report issue:
            severity: low
            confidence: firm
            detail: "Matched log_file"
            remediation: "Restrict access to log files and sanitize sensitive log content."
    end if

    if {latest.response} matches "[a-zA-Z0-9+/=]{30,50}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched alibaba_secret_key"
            remediation: "Rotate Alibaba secret key and remove from output."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{44}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched ibm_cloud_api_key"
            remediation: "Rotate IBM Cloud API key and remove from response content."
    end if

    if {latest.response} matches "kubeconfig" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched kubernetes_cluster_config"
            remediation: "Do not expose Kubernetes configuration artifacts."
    end if

    if {latest.response} matches "[A-Za-z0-9\\-_]{36}\\.[A-Za-z0-9\\-_]{8,}\\.[A-Za-z0-9\\-_]{12,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched k8s_bearer_token"
            remediation: "Rotate Kubernetes bearer token and remove from output."
    end if

    if {latest.response} matches "-----BEGIN OpenVPN Static key V1-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched openvpn_key"
            remediation: "Do not expose OpenVPN static keys; rotate compromised material."
    end if

    if {latest.response} matches "-----BEGIN CERTIFICATE-----" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched openvpn_cert"
            remediation: "Review certificate exposure and ensure no private material is leaked."
    end if

    if {latest.response} matches "-----BEGIN PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched openvpn_private_key"
            remediation: "Do not expose private keys in responses."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched twilio_auth_token"
            remediation: "Rotate Twilio auth token and remove from output."
    end if

    if {latest.response} matches "client_id=[a-zA-Z0-9-_]{20,}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched oauth_client_id"
            remediation: "Review OAuth client identifiers for unintended exposure."
    end if

    if {latest.response} matches "client_secret=[a-zA-Z0-9-_]{40,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched oauth_client_secret"
            remediation: "Rotate OAuth client secrets and remove from responses."
    end if

    if {latest.response} matches "access_token=[A-Za-z0-9\\-_]{30,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched oauth_access_token"
            remediation: "Rotate OAuth access tokens and avoid exposing them in output."
    end if

    if {latest.response} matches "https?://[a-zA-Z0-9\\-_\\.]+/(admin|dashboard|portal)" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched admin_portal"
            remediation: "Review exposure of administrative URLs and restrict where needed."
    end if

    if {latest.response} matches "-----BEGIN ENCRYPTED PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched openssl_private_key"
            remediation: "Do not expose encrypted private keys in responses."
    end if

    if {latest.response} matches "-----BEGIN (EC|RSA|DSA) PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched jwt_private_key"
            remediation: "Private key material should never be returned to clients."
    end if

    if {latest.response} matches "[a-zA-Z0-9_\\-]{32,64}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched encryption_secret"
            remediation: "Review and remove exposed encryption secrets."
    end if

    if {latest.response} matches "[a-f0-9]{32}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched md5_hash"
            remediation: "Review hash-like strings and ensure no sensitive artifacts are leaked."
    end if

    if {latest.response} matches "[a-f0-9]{40}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched sha1_hash"
            remediation: "Review hash-like strings and ensure no sensitive artifacts are leaked."
    end if

    if {latest.response} matches "[a-f0-9]{64}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched sha256_hash"
            remediation: "Review hash-like strings and ensure no sensitive artifacts are leaked."
    end if

    if {latest.response} matches "\\.(bak|backup|tmp|old|save)$" then
        report issue:
            severity: low
            confidence: firm
            detail: "Matched backup_extensions"
            remediation: "Restrict backup/tmp file exposure from web assets."
    end if

    if {latest.response} matches "\\.(log|debug|trace|dump)$" then
        report issue:
            severity: low
            confidence: firm
            detail: "Matched debug_files"
            remediation: "Restrict debug/trace file exposure and sanitize outputs."
    end if

    if {latest.response} matches "(?:[A-Za-z0-9+/]{4}){10,}(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched base64_encoded_v1"
            remediation: "Review large base64 blobs for accidental secret leakage."
    end if

    if {latest.response} matches "https?://[a-zA-Z0-9]+:[a-zA-Z0-9]+@[a-zA-Z0-9.-]+" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched password_in_url"
            remediation: "Remove credentials from URLs and rotate exposed passwords."
    end if

    if {latest.response} matches "LTAI[0-9A-Za-z]{20}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched aliyun_access_key"
            remediation: "Rotate Aliyun access key and remove from exposed output."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{30,50}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched aliyun_secret_key"
            remediation: "Rotate Aliyun secret key and remove from responses."
    end if

    if {latest.response} matches "sl\\.[a-zA-Z0-9_-]{15,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched dropbox_access_token"
            remediation: "Rotate Dropbox access token and remove from output."
    end if

    if {latest.response} matches "[a-z0-9-]+\\.appspot\\.com" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched firebase_storage_bucket"
            remediation: "Review Firebase bucket exposure and access controls."
    end if

    if {latest.response} matches "storage\\.googleapis\\.com/[a-zA-Z0-9\\-_]+" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched google_cloud_bucket"
            remediation: "Review Google Cloud bucket exposure and access controls."
    end if

    if {latest.response} matches "https://[a-zA-Z0-9\\-]+\\.blob\\.core\\.windows\\.net/[a-zA-Z0-9/-]+" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched azure_blob_url"
            remediation: "Review blob URL exposure and access controls."
    end if

    if {latest.response} matches "[a-zA-Z0-9+/]{64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched azure_function_key"
            remediation: "Rotate Azure function key if exposed."
    end if

    if {latest.response} matches "[a-zA-Z0-9\\-_]{36,72}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched microsoft_client_secret"
            remediation: "Rotate Microsoft client secrets and remove from outputs."
    end if

    if {latest.response} matches "Ew[A-Za-z0-9\\-]+" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched microsoft_oauth_token"
            remediation: "Rotate Microsoft OAuth token and remove from output."
    end if

    if {latest.response} matches "[a-zA-Z0-9_-]{24}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched google_client_secret"
            remediation: "Rotate Google client secret and remove from output."
    end if

    if {latest.response} matches "[a-zA-Z0-9\\-_]{8,50}==" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched session_cookie"
            remediation: "Avoid exposing session cookie values in responses."
    end if

    if {latest.response} matches "csrf_[a-zA-Z0-9]{8,}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched csrf_token"
            remediation: "Do not expose CSRF tokens in public responses."
    end if

    if {latest.response} matches "xsrf-token=[a-zA-Z0-9_-]{20,40}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched xsrf_token"
            remediation: "Do not expose XSRF tokens in response content."
    end if

    if {latest.response} matches "rzp_[a-zA-Z0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched razorpay_api_key"
            remediation: "Rotate Razorpay key and remove from response content."
    end if

    if {latest.response} matches "A[0-9a-zA-Z]{20,30}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched paypal_client_id_v2"
            remediation: "Review potential PayPal client identifier exposure."
    end if

    if {latest.response} matches "E[A-Za-z0-9-_]{30,50}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched paypal_client_secret_v2"
            remediation: "Rotate PayPal client secret and remove from output."
    end if

    if {latest.response} matches "AWS_[A-Za-z_]+=[a-zA-Z0-9/\\+=]{40,}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched env_aws_key"
            remediation: "Remove and rotate exposed AWS env credentials."
    end if

    if {latest.response} matches "DB_PASSWORD=[a-zA-Z0-9@#$%^&+=]{8,}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched env_db_credential"
            remediation: "Remove DB credentials from responses and rotate password."
    end if

    if {latest.response} matches "API_KEY=[a-zA-Z0-9-]{32,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched env_api_key"
            remediation: "Rotate API key and remove from output."
    end if

    if {latest.response} matches "-----BEGIN PUBLIC KEY-----" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched ssh_public_key"
            remediation: "Review public key exposure context."
    end if

    if {latest.response} matches "-----BEGIN RSA PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched aws_rsa_private_key"
            remediation: "Rotate exposed RSA private keys immediately."
    end if

    if {latest.response} matches "-----BEGIN EC PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched ec_private_key"
            remediation: "Rotate exposed EC private keys immediately."
    end if

    if {latest.response} matches "at [a-zA-Z0-9._]+\\(.*:\\d+\\)" then
        report issue:
            severity: low
            confidence: firm
            detail: "Matched stack_trace"
            remediation: "Limit stack trace leakage in production responses."
    end if

    if {latest.response} matches "log_level=[\\'\\\"]debug[\\'\\\"]" then
        report issue:
            severity: low
            confidence: firm
            detail: "Matched debug_log"
            remediation: "Disable debug logging exposure in production output."
    end if

    if {latest.response} matches "[a-zA-Z0-9_\\-]{40,}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched generic_token"
            remediation: "Review token-like values and remove active credentials."
    end if

    if {latest.response} matches "(?i)(key|token|secret|password|auth)[\\s:=\\'\\\"]+[a-zA-Z0-9-_]{8,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched api_key_prefix"
            remediation: "Remove key/token material from responses."
    end if

    if {latest.response} matches "(?<=\\s|=)[A-Za-z0-9+/]{40,}(={1,2})?" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched base64_encoded_v2"
            remediation: "Review base64 payloads for secret leakage."
    end if

    if {latest.response} matches "/(admin|backend|console|dashboard|manage|portal)(/|\\b)" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched admin_url"
            remediation: "Review administrative path exposure."
    end if

    if {latest.response} matches "/(swagger|api-docs|openapi|redoc|docs|graphql)" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched api_docs"
            remediation: "Review documentation endpoint exposure and access controls."
    end if

    if {latest.response} matches "/(tmp|storage|uploads|private|config|secrets)[/\\w\\.-]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched local_file_path"
            remediation: "Avoid exposing sensitive local file path details."
    end if

    if {latest.response} matches "pip install --extra-index-url https://[a-zA-Z0-9:_-]+@pypi" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched py_pip_secrets"
            remediation: "Remove embedded package repository credentials."
    end if

    if {latest.response} matches "basic\\s+[a-zA-Z0-9=:_\\+/-]{10,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched exposed_basic_auth"
            remediation: "Do not expose basic auth credentials in responses."
    end if

    if {latest.response} matches "bearer\\s+[a-zA-Z0-9_.=:+/_-]{10,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched exposed_bearer_auth"
            remediation: "Do not expose bearer auth tokens in responses."
    end if

    if {latest.response} matches "(user|admin|root|test|guest)[:\\s]*(password|1234|admin|guest)" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched generic_password"
            remediation: "Remove weak/default credential indicators from output."
    end if

    if {latest.response} matches "(aes|rsa|dsa|ecdsa|seed|key)[\"\\']?\\s*[:=]\\s*[\"\\']?[A-Za-z0-9/+=]{16,64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched encryption_key"
            remediation: "Do not expose encryption keys or key-like material."
    end if

    if {latest.response} matches "jwt[\"\\']?\\s*[:=]\\s*[\"\\']?[A-Za-z0-9/+=]{16,64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched jwt_secret"
            remediation: "Rotate JWT secret and remove from responses."
    end if

    if {latest.response} matches "/graphql\\b" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched graphql_endpoint"
            remediation: "Review GraphQL endpoint exposure and auth controls."
    end if

    if {latest.response} matches "query\\s*[{]" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched graphql_query"
            remediation: "Review whether GraphQL query content should be exposed."
    end if

    if {latest.response} matches "__schema\\b" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched introspection_query"
            remediation: "Disable GraphQL introspection in production where appropriate."
    end if

    if {latest.response} matches "(?i)(api|secret|token|key|password|auth)[\"\\'=\\s]{0,10}[a-zA-Z0-9-_]{8,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched proximity_secret"
            remediation: "Remove proximity-discovered secret material from output."
    end if

    if {latest.response} matches "(console|window)\\.(debug|log|info)\\s*[(]" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched exposed_debug_vars"
            remediation: "Remove debug variable/logging artifacts from production responses."
    end if

    if {latest.response} matches "https://s3\\.amazonaws\\.com/[a-zA-Z0-9._-]+" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched hardcoded_s3"
            remediation: "Review hardcoded S3 URLs and ensure intended exposure."
    end if

    if {latest.response} matches "https://[a-z0-9-]+\\.firebaseio\\.com" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched hardcoded_firebase"
            remediation: "Review hardcoded Firebase URLs and access controls."
    end if

    if {latest.response} matches "bitbucket_[a-zA-Z0-9]{35}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched bitbucket_key"
            remediation: "Rotate Bitbucket credential and remove from output."
    end if

    if {latest.response} matches "yarn_[a-zA-Z0-9]{40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched yarn_npm_token"
            remediation: "Rotate Yarn/NPM token and remove from output."
    end if

    if {latest.response} matches "(<!--.*?(api|key|token|secret).*?-->)" then
        report issue:
            severity: medium
            confidence: firm
            detail: "Matched comments_secrets"
            remediation: "Remove secrets from HTML comments and rotate compromised values."
    end if

    if {latest.response} matches "<meta.*?(api|key|token|secret).*?>" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched html_inline_secrets"
            remediation: "Remove inline secret metadata from HTML responses."
    end if

    if {latest.response} matches "AIza[0-9A-Za-z-_]{35}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched android_firebase_key"
            remediation: "Restrict and rotate Firebase/Google API key if needed."
    end if

    if {latest.response} matches "AIza[0-9A-Za-z-_]{35}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched google_maps_key_android"
            remediation: "Restrict Maps API key and remove from exposed artifacts if inappropriate."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{64}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched ios_apns_key"
            remediation: "Review APNS key exposure and rotate if this is active key material."
    end if

    if {latest.response} matches "[0-9]{13}:[a-zA-Z0-9]{32}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched firebase_app_id_ios"
            remediation: "Review iOS Firebase app identifier exposure."
    end if

    if {latest.response} matches "http(s)?://[a-zA-Z0-9._-]+/firmware" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched firmware_update_url"
            remediation: "Review firmware endpoint exposure and authentication requirements."
    end if

    if {latest.response} matches "(iot|device|api|key|token)[\\s:=\\'\\\"]{0,10}[a-zA-Z0-9+/=]{16,64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched iot_hardcoded_key"
            remediation: "Remove hardcoded IoT keys/tokens from responses."
    end if

    if {latest.response} matches "[A-Z0-9]{2,5}-[A-Z0-9]{6,10}-[0-9]{4,6}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched serial_number_pattern"
            remediation: "Review serial number exposure if device identifiers are sensitive."
    end if

    if {latest.response} matches "process\\.env\\.[A-Z_]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched aws_lambda_env_vars"
            remediation: "Avoid exposing runtime environment variable references."
    end if

    if {latest.response} matches "\"type\":\\s*\"service_account\"" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched gcloud_function_key"
            remediation: "Do not expose service-account credentials in function artifacts."
    end if

    if {latest.response} matches "[A-Z0-9]{4,6}-[A-Z0-9]{4,6}-[A-Z0-9]{4,6}-[A-Z0-9]{4,6}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched software_license_key"
            remediation: "Review software license key exposure."
    end if

    if {latest.response} matches "[A-Za-z0-9]{25,50}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched proprietary_license_key"
            remediation: "Review possible proprietary key exposure."
    end if

    if {latest.response} matches "[a-f0-9]{32}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched cloudflare_zone_id"
            remediation: "Review whether zone IDs and related metadata should be public."
    end if

    if {latest.response} matches "/jenkins/" then
        report issue:
            severity: medium
            confidence: firm
            detail: "Matched jenkins_exposed"
            remediation: "Restrict Jenkins endpoints and enforce authentication."
    end if

    if {latest.response} matches "travis-ci\\.org/" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched travis_exposed"
            remediation: "Review CI metadata exposure in responses."
    end if

    if {latest.response} matches "circleci\\.com/" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched circleci_exposed"
            remediation: "Review CI metadata exposure in responses."
    end if

    if {latest.response} matches "(?:[0-9]{1,3}\\.){3}[0-9]{1,3}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched hardcoded_ips"
            remediation: "Review hardcoded IP exposure and ensure no internal addresses leak."
    end if

    if {latest.response} matches "[a-z0-9]{32}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched mixpanel_api_key"
            remediation: "Rotate analytics keys if sensitive and not intended for client exposure."
    end if

    if {latest.response} matches "NR[a-f0-9]{17,40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched new_relic_key"
            remediation: "Rotate New Relic key and remove from output."
    end if

    if {latest.response} matches "1f[a-f0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched segment_api_key"
            remediation: "Rotate Segment key and remove from output."
    end if

    if {latest.response} matches "sagemaker\\.[a-zA-Z0-9\\-]+\\.amazonaws\\.com" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched aws_sagemaker_url"
            remediation: "Review internal service endpoint exposure."
    end if

    if {latest.response} matches "gpt-[a-zA-Z0-9_\\-]{20,40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched gpt_service_key"
            remediation: "Rotate GPT service key and remove from exposed content."
    end if

    if {latest.response} matches "^\\$ANSIBLE_VAULT;[0-9\\.]+;" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched ansible_vault"
            remediation: "Do not expose vault-encrypted secrets files in responses."
    end if

    if {latest.response} matches "[a-zA-Z0-9+/]{40,64}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched saltstack_key"
            remediation: "Review potential SaltStack/key material exposure."
    end if

    if {latest.response} matches "\"sensitive\":\\s*true" then
        report issue:
            severity: medium
            confidence: firm
            detail: "Matched terraform_state"
            remediation: "Prevent Terraform state exposure in client-facing assets."
    end if

    if {latest.response} matches "packer_[a-zA-Z0-9]{40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched packer_api_key"
            remediation: "Rotate Packer API key and remove from output."
    end if

    if {latest.response} matches "ghp_[a-zA-Z0-9]{36}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched github_package_registry"
            remediation: "Rotate GitHub package registry token and remove from output."
    end if

    if {latest.response} matches "pip://.*@.*" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched pip_repository_key"
            remediation: "Remove embedded repository credentials from pip URLs."
    end if

    if {latest.response} matches "0x[a-fA-F0-9]{40}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched ethereum_wallet_key"
            remediation: "Review blockchain address/key exposure in responses."
    end if

    if {latest.response} matches "[13][a-km-zA-HJ-NP-Z1-9]{25,34}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched bitcoin_wallet_key"
            remediation: "Review wallet address/key exposure in responses."
    end if

    if {latest.response} matches "bc[a-zA-Z0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched blockchain_api_key"
            remediation: "Rotate blockchain API key and remove from output."
    end if

    if {latest.response} matches "Bearer\\s+[A-Za-z0-9-_]{20,}\\.[A-Za-z0-9-_]{10,}\\.[A-Za-z0-9-_]{15,}\\s+scope=[\"\\'][a-zA-Z0-9\\s_,]+[\"\\']" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched oauth_token_scope"
            remediation: "Do not expose scoped OAuth bearer tokens in responses."
    end if

    if {latest.response} matches "shpss_[a-f0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched shopify_shared_secret"
            remediation: "Rotate Shopify shared secret and remove from output."
    end if

    if {latest.response} matches "shapka_[a-f0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched shopify_admin_api_key"
            remediation: "Rotate Shopify admin API key and remove from output."
    end if

    if {latest.response} matches "-----BEGIN PRIVATE KEY-----.*-----END PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched firebase_private_key"
            remediation: "Remove private key material and rotate leaked credentials."
    end if

    if {latest.response} matches "AIza[0-9A-Za-z-_]{35}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched firebase_web_api_key"
            remediation: "Restrict Firebase web API key and validate intended exposure."
    end if

    if {latest.response} matches "\"sensitive\":\\s*true" then
        report issue:
            severity: medium
            confidence: firm
            detail: "Matched terraform_state_sensitive"
            remediation: "Prevent Terraform state leakage in responses."
    end if

    if {latest.response} matches "\"adminPassword\":\\s*\"[a-zA-Z0-9@#$%^&+=]{8,}\"" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched grafana_admin_password"
            remediation: "Rotate Grafana admin password and remove from output."
    end if

    if {latest.response} matches "(secret|key|token)[\"\\']?\\s*[:=]\\s*[\"\\']?[a-zA-Z0-9-_]{16,64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched secret_key_general"
            remediation: "Remove generalized secret/key/token material from output."
    end if

    if {latest.response} matches "(password)[\"\\']?\\s*[:=]\\s*[\"\\']?[a-zA-Z0-9@#$%^&+=]{8,64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched password_general"
            remediation: "Remove generalized password material from output."
    end if

    if {latest.response} matches "(config|secret|key|token|auth|password)[-_]?[a-zA-Z0-9]+\\.(json|yml|env|xml|log)" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched secret_in_file"
            remediation: "Review file/path exposure indicating secret-bearing files."
    end if

    if {latest.response} matches "do_api_key[\"\\']?\\s*[:=]\\s*[\"\\'][a-zA-Z0-9]{40,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched digitalocean_api_key"
            remediation: "Rotate DigitalOcean API key and remove from output."
    end if

    if {latest.response} matches "ocid1\\.tenancy\\.[a-zA-Z0-9\\-_\\.]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched oracle_cloud_tenancy"
            remediation: "Review Oracle tenancy identifier exposure."
    end if

    if {latest.response} matches "ocid1\\.user\\.[a-zA-Z0-9\\-_\\.]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched oracle_cloud_user"
            remediation: "Review Oracle user identifier exposure."
    end if

    if {latest.response} matches "fingerprint=[\"\\'][a-f0-9:]{47}[\"\\']" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched oracle_cloud_fingerprint"
            remediation: "Review cloud credential fingerprint exposure."
    end if

    if {latest.response} matches "linode_[a-zA-Z0-9]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched linode_api_token"
            remediation: "Rotate Linode API token and remove from output."
    end if

    if {latest.response} matches "kubeadmin[\"\\']?\\s*[:=]\\s*[\"\\'][a-zA-Z0-9/+=]{32,64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched kubernetes_admin_config"
            remediation: "Remove Kubernetes admin config credentials from outputs."
    end if

    if {latest.response} matches "[A-Za-z0-9]{6}\\.[A-Za-z0-9]{16}\\.[A-Za-z0-9_-]{32,64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched kubernetes_cluster_token"
            remediation: "Rotate cluster token and remove from output."
    end if

    if {latest.response} matches "https://index\\.docker\\.io/v1/[a-zA-Z0-9_=-]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched docker_registry_token"
            remediation: "Remove Docker registry tokens from responses."
    end if

    if {latest.response} matches "\"auths\":\\s*[{].*[}]" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched docker_config_auth"
            remediation: "Do not expose docker auth configuration in responses."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{32}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched jenkins_token"
            remediation: "Review Jenkins token exposure and rotate if active."
    end if

    if {latest.response} matches "[a-zA-Z0-9\\-_]{20,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched gitlab_runner_registration_token"
            remediation: "Rotate GitLab runner registration token and remove from output."
    end if

    if {latest.response} matches "[a-zA-Z0-9_-]{30,50}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched circleci_api_token"
            remediation: "Rotate CircleCI API token and remove from output."
    end if

    if {latest.response} matches "[a-f0-9]{40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched travisci_api_token"
            remediation: "Rotate TravisCI API token and remove from output."
    end if

    if {latest.response} matches "https://[a-zA-Z0-9]+\\.webhook\\.office\\.com/webhookb2/[a-zA-Z0-9-]+@[a-zA-Z0-9-]+/IncomingWebhook/[a-zA-Z0-9-]+/[a-zA-Z0-9-]+" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched teams_webhook_url"
            remediation: "Regenerate Teams webhook and remove from output."
    end if

    if {latest.response} matches "AIza[0-9A-Za-z-_]{35}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched google_maps_android_key"
            remediation: "Restrict Google Maps Android key and remove if inappropriately exposed."
    end if

    if {latest.response} matches "[0-9]{13}:[a-zA-Z0-9]{32}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched firebase_ios_key"
            remediation: "Review Firebase iOS key exposure."
    end if

    if {latest.response} matches "0x[a-fA-F0-9]{64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched ethereum_private_key"
            remediation: "Treat as highly sensitive private key material and rotate immediately."
    end if

    if {latest.response} matches "[13][a-km-zA-HJ-NP-Z1-9]{25,34}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched bitcoin_wallet_address"
            remediation: "Review wallet address exposure context."
    end if

    if {latest.response} matches "https://s3\\.amazonaws\\.com/[a-zA-Z0-9\\-_/]+" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched aws_s3_bucket_url"
            remediation: "Review S3 bucket URL exposure and access controls."
    end if

    if {latest.response} matches "[a-zA-Z0-9\\-_]{3,63}\\.s3\\.amazonaws\\.com" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched aws_s3_bucket_name"
            remediation: "Review S3 bucket naming exposure and ACLs."
    end if

    if {latest.response} matches "https://[a-z0-9-]+\\.appspot\\.com" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched firebase_storage_url"
            remediation: "Review Firebase storage URL exposure and ACLs."
    end if

    if {latest.response} matches "[a-f0-9]{40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched new_relic_license_key"
            remediation: "Rotate New Relic license key and remove from output."
    end if

    if {latest.response} matches "(?i)aws_secret_access_key[\"\\']?\\s*[:=]\\s*[\"\\'][a-zA-Z0-9/+=]{40}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched aws_secret_key"
            remediation: "Rotate AWS secret key immediately and remove from outputs."
    end if

    if {latest.response} matches "https://[a-zA-Z0-9\\-_\\.]+\\.s3\\.amazonaws\\.com/" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched aws_s3_url"
            remediation: "Review S3 URL exposure and ensure proper ACL."
    end if

    if {latest.response} matches "[a-zA-Z0-9\\-_]{3,63}\\.s3\\.amazonaws\\.com" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched aws_s3_bucket"
            remediation: "Review S3 bucket exposure and ensure proper ACL."
    end if

    if {latest.response} matches "\"private_key\":\\s*\"-----BEGIN PRIVATE KEY-----[a-zA-Z0-9/+=\\n]+-----END PRIVATE KEY-----\"" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched gcp_private_key"
            remediation: "Rotate exposed GCP private key and remove from output."
    end if

    if {latest.response} matches "(?i)(azure_client_id|client_id)[\"\\']?\\s*[:=]\\s*[\"\\'][0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched azure_client_id_named"
            remediation: "Review Azure client identifiers and remove unnecessary exposure."
    end if

    if {latest.response} matches "[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched azure_tenant_id_plain"
            remediation: "Review tenant identifier exposure where not required."
    end if

    if {latest.response} matches "LTAI[0-9A-Za-z]{20}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched alibaba_access_key_id"
            remediation: "Rotate Alibaba access key ID if paired secret exposure is suspected."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{30,50}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched alibaba_secret_access_key"
            remediation: "Rotate Alibaba secret access key and remove from output."
    end if

    if {latest.response} matches "-----BEGIN RSA PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched rsa_private_key"
            remediation: "Rotate leaked RSA private keys immediately."
    end if

    if {latest.response} matches "-----BEGIN DSA PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched dsa_private_key"
            remediation: "Rotate leaked DSA private keys immediately."
    end if

    if {latest.response} matches "-----BEGIN EC PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched ecdsa_private_key"
            remediation: "Rotate leaked ECDSA private keys immediately."
    end if

    if {latest.response} matches "-----BEGIN PGP PRIVATE KEY BLOCK-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched pgp_private_key"
            remediation: "Do not expose PGP private keys in responses."
    end if

    if {latest.response} matches "pk_live_[0-9a-zA-Z]{24}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched stripe_publishable_key_v2"
            remediation: "Confirm publishable key usage is intended and scoped."
    end if

    if {latest.response} matches "(?i)client_id[\"\\']?\\s*[:=]\\s*[\"\\'][A-Za-z0-9_-]{20,40}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched paypal_client_id_v3"
            remediation: "Review PayPal client ID exposure in configs/responses."
    end if

    if {latest.response} matches "(?i)client_secret[\"\\']?\\s*[:=]\\s*[\"\\'][A-Za-z0-9_-]{20,40}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched paypal_client_secret_v3"
            remediation: "Rotate PayPal client secret and remove from outputs."
    end if

    if {latest.response} matches "access_token\\$production\\$[0-9a-z]{16}\\$[0-9a-f]{32}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched braintree_access_token"
            remediation: "Rotate Braintree token and remove it from responses."
    end if

    if {latest.response} matches "[a-f0-9]{40}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched travisci_auth_key"
            remediation: "Rotate TravisCI auth key if exposed."
    end if

    if {latest.response} matches "kubeconfig:\\s*[a-zA-Z0-9/+=]{64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched k8s_cluster_config"
            remediation: "Do not expose Kubernetes cluster config values."
    end if

    if {latest.response} matches "access_token\\$production\\$[0-9a-z]{16}\\$[0-9a-f]{32}" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched paypal_access_token"
            remediation: "Rotate PayPal access token and remove from output."
    end if

    if {latest.response} matches "^[a-zA-Z0-9]{32}$" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched adyen_api_key"
            remediation: "Rotate Adyen API key and remove from outputs."
    end if

    if {latest.response} matches "[a-zA-Z0-9_-]{32}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched discord_client_secret"
            remediation: "Rotate Discord client secret and remove from output."
    end if

    if {latest.response} matches "[a-zA-Z0-9-]+\\.[a-zA-Z0-9-]+\\.iot\\.[a-zA-Z0-9-]+\\.amazonaws\\.com" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched aws_iot_mqtt_url"
            remediation: "Review IoT MQTT endpoint exposure."
    end if

    if {latest.response} matches "-----BEGIN DEVICE KEY-----[a-zA-Z0-9/+=\\n]+-----END DEVICE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched aws_iot_device_key"
            remediation: "Rotate device keys and remove exposed key material."
    end if

    if {latest.response} matches "at [a-zA-Z0-9._]+\\(.*:\\d+\\)" then
        report issue:
            severity: low
            confidence: firm
            detail: "Matched stack_trace_log"
            remediation: "Avoid stack trace leakage in production responses."
    end if

    if {latest.response} matches "(?i)debug_token[\"\\']?\\s*[:=]\\s*[\"\\'][a-zA-Z0-9/+=]{20,}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched debug_token"
            remediation: "Rotate debug token and remove it from output."
    end if

    if {latest.response} matches "https?://[a-zA-Z0-9._-]+/webhook/[a-zA-Z0-9_-]+" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched generic_webhook_url"
            remediation: "Review webhook URL exposure and associated auth controls."
    end if

    if {latest.response} matches "-----BEGIN PRIVATE KEY-----[a-zA-Z0-9/+=]+-----END PRIVATE KEY-----" then
        report issue:
            severity: high
            confidence: firm
            detail: "Matched apns_private_key"
            remediation: "Rotate APNS private key and remove from output."
    end if

    if {latest.response} matches "[0-9]{13}:[a-zA-Z0-9_-]{32}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched firebase_mobile_key"
            remediation: "Review mobile Firebase key exposure."
    end if

    if {latest.response} matches "[a-zA-Z0-9]{32}" then
        report issue:
            severity: medium
            confidence: tentative
            detail: "Matched segment_write_key"
            remediation: "Rotate Segment write key and remove from output if sensitive."
    end if

    if {latest.response} matches "[A-Za-z0-9-]{25,50}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched ssh_license_key"
            remediation: "Review potential license/credential key exposure."
    end if

    if {latest.response} matches "[A-Z0-9]{4,6}-[A-Z0-9]{4,6}-[A-Z0-9]{4,6}" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched generic_license_key"
            remediation: "Review generic license key exposure."
    end if

    if {latest.response} matches "https?://[a-zA-Z0-9._-]+/firmware/update" then
        report issue:
            severity: low
            confidence: tentative
            detail: "Matched firmware_update_url_v2"
            remediation: "Review firmware update URL exposure and controls."
    end if

    if {latest.response} matches "(?i)(secret|key|password|token)[\\s:=]{0,10}[\"\\'][a-zA-Z0-9]{8,64}" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched sensitive_proximity"
            remediation: "Remove proximity-discovered secrets from output."
    end if

    if {latest.response} matches "(?i)(password)[\"\\']?\\s*[:=]\\s*[\"\\'][^\\'\\\"]+[\"\\']" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched password_pattern"
            remediation: "Remove password assignments from responses."
    end if

    if {latest.response} matches "(?i)(key)[\"\\']?\\s*[:=]\\s*[\"\\'][^\\'\\\"]+[\"\\']" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched key_pattern"
            remediation: "Remove key assignments from responses."
    end if

    if {latest.response} matches "(?i)(token)[\"\\']?\\s*[:=]\\s*[\"\\'][a-zA-Z0-9-_]+[\"\\']" then
        report issue:
            severity: high
            confidence: tentative
            detail: "Matched token_pattern"
            remediation: "Remove token assignments from responses and rotate if active."
    end if

